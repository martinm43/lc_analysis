#MAM - 16 Jan 16 

#Parsing data obtained from basketball-reference.com 
#for use in analyses. Your first Python program. 


#Replace Excel Program with Python routine.
import csv, os

#This is the best way that I can think of to convert the team names into the 1-30 numbers required for 
#calculating SRS. Here goes...
def teamind ( str ):
	if str=='Atlanta Hawks':
		return 1
	if str=='Boston Celtics':
		return 2
	if str=='Brooklyn Nets':
		return 3
	if str=='Charlotte Hornets':
		return 4
	if str=='Chicago Bulls':
		return 5
	if str=='Cleveland Cavaliers':
		return 6
	if str=='Dallas Mavericks':
		return 7
	if str=='Denver Nuggets':
		return 8
	if str=='Detroit Pistons':
		return 9
	if str=='Golden State Warriors':
		return 10
	if str=='Houston Rockets':
		return 11
	if str=='Indiana Pacers':
		return 12
	if str=='Los Angeles Clippers':
		return 13
	if str=='Los Angeles Lakers':
		return 14
	if str=='Memphis Grizzlies':
		return 15
	if str=='Miami Heat':
		return 16
	if str=='Milwaukee Bucks':
		return 17
	if str=='Minnesota Timberwolves':
		return 18
	if str=='New Orleans Pelicans':
		return 19
	if str=='New York Knicks':
		return 20
	if str=='Oklahoma City Thunder':
		return 21
	if str=='Orlando Magic':
		return 22
	if str=='Philadelphia 76ers':
		return 23
	if str=='Phoenix Suns':
		return 24
	if str=='Portland Trail Blazers':
		return 25
	if str=='Sacramento Kings':
		return 26
	if str=='San Antonio Spurs':
		return 27
	if str=='Toronto Raptors':
		return 28
	if str=='Utah Jazz':
		return 29
	if str=='Washington Wizards':
		return 30
	else:
		return str


#strings for getting to file locations 
phone = ''

ballrows = []
with open(phone+'2017_schedule.csv','rb') as csvfile:
	balldata = csv.reader(csvfile,delimiter=',')
	headers=balldata.next()
	for row in balldata:
		ballrows.append(row)
	csvfile.close
	
#Part one and a half
for row in ballrows:
	print(row)
 	row[2]=teamind(row[2])
	row[4]=teamind(row[4])

#Convert first row into datetime obj
import time
for row in ballrows:
  tstr=row[0] +' '+row[1]
  q=time.strptime(tstr,'%a %b %d %Y %I:%M %p') 
  row[0]=q

#Write out a file containing all games played
csvfile_out = open(phone+'outfile_gms_all_2017.csv','wb')
csvwriter = csv.writer(csvfile_out)
for row in ballrows:
	#Only need to print the visiting and home team scores and names.
	csvwriter.writerow([row[0],row[2],row[4]])
csvfile_out.close()
